---
title: Vue.jsのスタイルガイドまとめ
permalink: vue-style-guide
description: 
created_at: 2020-04-06
tags: Vue
---

このページはVue.jsスタイルガイドの要約というよりは、個人的に分かりにく部分に対し内容を深堀りした記事です。対象範囲は、単一ファイルコンポーネント（.vue）に対してです。  
[スタイルガイド — Vue.js](https://jp.vuejs.org/v2/style-guide/index.html)  

# ルールカテゴリ

| 優先度 | 内容 |
| ---- | ---- |
| A:必須 | エラー防止 |
| B:強く推奨 | 読みやすさ向上 |
| C:推奨 | 一貫性の確保 |
| D:使用注意 | 潜在的な不具合の回避 |

# A:必須

## 【複数単語コンポーネント名】
コンポーネント名は常に複数単語にします。全てのHTML要素は1単語のため、HTML要素との衝突を防止します。  

**悪い例**  
```
export default {
  name: 'Todo',
  // ...
}
```

**良い例**  
```
export default {
  name: 'TodoItem',
  // ...
}
```

## 【コンポーネントのデータ】
コンポーネントのdataは、オブジェクトを返す関数でなければなりません。  

**悪い例**  
```
export default {
  data: {
    foo: 'bar'
  }
}
```

**良い例**  
```
export default {
  data () {
    return {
      foo: 'bar'
    }
  }
}
```

**補足**  
dataの値がオブジェクトの時、コンポーネントの全てのインスタンスで共有されるため、他のインスタンスのdataの値を書き換えてしまいます。

## 【プロパティの定義】
プロパティの定義はできる限り詳しく書きます。

**悪い例**  
```
props: ['status']
```

**良い例**  
```
props: {
  status: String
}
```

**補足**  
上記の例の場合、statusにString以外の型が渡されると、ディベロッパーツールのConsoleに警告を出して知らせてくれます。  

以下のようにプロパティの定義を複数設定することもできます。
```
props: {
  status: {
    type: String,
    default: '',
    required: true
  }
}
```

更にvalidatorを設定することができます。次の例では、配列statusの各文字数が10文字以下か否かのチェックをしています。everyメソッドを使うことで全ての値が10文字以上だった場合、trueを返すようにしています。
```
props: {
  status: {
    type: Array,
    required: true,
    validator (arrayValue) {
      return arrayValue.every( v => v.length <= 10 )
    }
  }
}
```

## 【キー付き v-for】
keyは仮想DOMの差分から実際のDOMに反映させるときに、最小限の変更するために使われます。差分算出のため、描画のパフォーマンスの向上に繋がります。  
参考：[API — Vue.js](https://jp.vuejs.org/v2/api/#key)  


**悪い例**  
```
<ul>
  <li v-for="todo in todos">
    {{ todo.text }}
  </li>
</ul>
```

**良い例**  
```
<ul>
  <li
    v-for="todo in todos"
    :key="todo.id"
  >
    {{ todo.text }}
  </li>
</ul>
```

**補足**  
DOMの内容が単純な場合や、要素の追加や削除がない場合に限り、keyを使わなくても問題はないようです。  
参考：[リストレンダリング — Vue.js](https://jp.vuejs.org/v2/guide/list.html#状態の維持)  
  
&#13;&#10;
  
※v-forでkey属性にindexを使って良いのか問題  
  
&#13;&#10;
  
v-forで第2引数を指定すると、配列インデックスを受け取れます。  
```
<ul>
  <li
    v-for="(todo, index) in todos"
    :key="index"
  >
    {{ todo.text }}
  </li>
</ul>
```
  
&#13;&#10;
  
配列インデックスをkeyに指定するのは、結論NGです。要素の追加や削除があった場合、インデックスは振り直されるため、付与されていたインデックスが変わってしまいます。インデックスが変わると不具合を起こしかねません。  
  
&#13;&#10;
  
「インデックスが振り直される」のイメージを持っていただくため [サンプルページ](https://chida.blog/sample/keytest) を作成しました。ページ内ではユーザー名を並べています。id: usernameの形式で10名いますが、ボタンをクリックするとユーザーが削除され、keyが振り直されていることが確認できます。見た目上は削除できていますが、データ上「id = username」の関係にならないため、ユーザーの特定が不可になります（同姓同名が存在していたら、どれが正しいか判別できません）
  
&#13;&#10;
  
つまり、一意のidが振れない場合は、無理してインデックスは使うことはないです。ちなみにkeyを指定しない場合は、配列インデックスと同じ扱いになります。  
  
&#13;&#10;
  
参考：[Vue.js: v-forで項目インデックスをkey属性にしていいのか](https://qiita.com/FumioNonaka/items/d1d9c9335116426a8316)  
  
&#13;&#10;
  
※中途半端になったため、また改めて更新します。

