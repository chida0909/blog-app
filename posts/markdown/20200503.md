---
title: Vuexを使ってログイン認証を実装する
permalink: vuex-store-authenticated
description: 
created_at: 2020-05-03
tags: Vuex
---

Nuxtの公式サイトに[Vueストア](https://ja.nuxtjs.org/guide/vuex-store/)と[middlewareプロパティ](https://ja.nuxtjs.org/api/pages-middleware/)の説明がありますので、こちらを参考にVuexを使ってログイン認証を実装していきます。
  
Nuxtのストアは「クラシックモード」と「モジュールモード」の2つの書き方がありますが、クラシックモードは廃止予定のモジュールモードで書きます。

## middlewareの用意
middleware/authenticated.jsを作成します。

```js
export default function ({ store, redirect }) {
  // ユーザーが認証されていないとき
  if (!store.state.authenticated) {
    return redirect('/login')
  }
}
```

次にpages/secret.vueを作成します。
```vue
<template>
  <h1>シークレットページ</h1>
</template>

<script>
export default {
  middleware: 'authenticated'
}
</script>
```

これで/secretにアクセスすると「An error occurred」とエラーになり、/loginページに遷移することが分かります。middlewareのコードをコメントアウトすると問題なくページが表示されます。

## storeの用意
store/index.jsを作成します。

```js
export const state = () => ({
  authenticated: true
})
```

これで/secretに再度、アクセスするとエラーは発生せず、ページが表示されました。Vuexを使えていることが確認できます。


## 
